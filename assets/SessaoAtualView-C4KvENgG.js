import{d as X,s as m,r as P,w as I,a as K,c as i,o as n,b as e,t as v,e as E,f as a,v as V,F as U,g as N,h as Y,i as B,j as F,_ as Z,u as D,k as ee,l as se,m as T,n as te,p as J,q as oe,x as ne}from"./index-D2RIzyMw.js";const ae=X("sessions",{state:()=>({sessions:[],activeSession:null,loading:!1,error:null}),actions:{async fetchSessions(t){if(this.loading=!0,this.error=null,!t){this.sessions=[],this.loading=!1;return}try{const{data:o,error:f}=await m.from("sessions").select("*").eq("campaign_id",t).order("created_at",{ascending:!1});if(f)throw f;this.sessions=o}catch(o){this.error=o.message}finally{this.loading=!1}},async fetchLatestSessionWithDetails(t){if(this.loading=!0,this.error=null,this.activeSession=null,!t){this.loading=!1;return}try{const{data:o,error:f}=await m.from("sessions").select(`
            *,
            session_encontros_desafios(*),
            session_ganchos_personagens(*),
            session_locais_interessantes(*, session_locais_caracteristicas(*)),
            session_npcs_importantes(*, npcs(id, name, concept, image)),
            session_objetivos(*),
            session_segredos_rumores(*),
            session_tesouros_recompensas(*)
          `).eq("campaign_id",t).order("created_at",{ascending:!1}).limit(1).single();if(f)if(f.code==="PGRST116")console.log("Nenhuma sessão encontrada para esta campanha."),this.activeSession=null;else throw f;else this.activeSession=o}catch(o){this.error=o.message,console.error("Erro ao buscar sessão mais recente:",o)}finally{this.loading=!1}},async addSession(t){this.loading=!0,this.error=null;try{const{title:o,description:f,comeco_forte:q,gancho_proxima_aventura:r,campaign_id:C}=t,{data:k,error:j}=await m.from("sessions").insert({title:o,description:f,comeco_forte:q,gancho_proxima_aventura:r,campaign_id:C}).select().single();if(j)throw j;const w=k.id,y=[];if(t.session_objetivos&&t.session_objetivos.length>0&&y.push(m.from("session_objetivos").insert(t.session_objetivos.map(_=>({..._,session_id:w})))),t.session_ganchos_personagens&&t.session_ganchos_personagens.length>0&&y.push(m.from("session_ganchos_personagens").insert(t.session_ganchos_personagens.map(_=>({..._,session_id:w})))),t.session_locais_interessantes&&t.session_locais_interessantes.length>0)for(const _ of t.session_locais_interessantes){const{data:A,error:x}=await m.from("session_locais_interessantes").insert({name:_.name,session_id:w}).select().single();if(x)throw x;_.session_locais_caracteristicas&&_.session_locais_caracteristicas.length>0&&y.push(m.from("session_locais_caracteristicas").insert(_.session_locais_caracteristicas.map(L=>({...L,local_id:A.id}))))}t.session_npcs_importantes&&t.session_npcs_importantes.length>0&&y.push(m.from("session_npcs_importantes").insert(t.session_npcs_importantes.map(_=>({..._,session_id:w})))),t.session_encontros_desafios&&t.session_encontros_desafios.length>0&&y.push(m.from("session_encontros_desafios").insert(t.session_encontros_desafios.map(_=>({..._,session_id:w})))),t.session_segredos_rumores&&t.session_segredos_rumores.length>0&&y.push(m.from("session_segredos_rumores").insert(t.session_segredos_rumores.map(_=>({..._,session_id:w})))),t.session_tesouros_recompensas&&t.session_tesouros_recompensas.length>0&&y.push(m.from("session_tesouros_recompensas").insert(t.session_tesouros_recompensas.map(_=>({..._,session_id:w})))),await Promise.all(y),this.sessions.unshift(k),await this.fetchLatestSessionWithDetails(C)}catch(o){this.error=o.message}finally{this.loading=!1}},async updateSession(t){this.loading=!0,this.error=null;try{const{id:o,title:f,description:q,comeco_forte:r,gancho_proxima_aventura:C,campaign_id:k}=t,{data:j,error:w}=await m.from("sessions").update({title:f,description:q,comeco_forte:r,gancho_proxima_aventura:C}).eq("id",o).select().single();if(w)throw w;const y=[m.from("session_objetivos").delete().eq("session_id",o),m.from("session_ganchos_personagens").delete().eq("session_id",o),m.from("session_locais_interessantes").delete().eq("session_id",o),m.from("session_npcs_importantes").delete().eq("session_id",o),m.from("session_encontros_desafios").delete().eq("session_id",o),m.from("session_segredos_rumores").delete().eq("session_id",o),m.from("session_tesouros_recompensas").delete().eq("session_id",o)];await Promise.all(y);const _=[];if(t.session_objetivos&&t.session_objetivos.length>0&&_.push(m.from("session_objetivos").insert(t.session_objetivos.map(x=>({...x,session_id:o})))),t.session_ganchos_personagens&&t.session_ganchos_personagens.length>0&&_.push(m.from("session_ganchos_personagens").insert(t.session_ganchos_personagens.map(x=>({...x,session_id:o})))),t.session_locais_interessantes&&t.session_locais_interessantes.length>0)for(const x of t.session_locais_interessantes){const{data:L,error:R}=await m.from("session_locais_interessantes").insert({name:x.name,session_id:o}).select().single();if(R)throw R;x.session_locais_caracteristicas&&x.session_locais_caracteristicas.length>0&&_.push(m.from("session_locais_caracteristicas").insert(x.session_locais_caracteristicas.map($=>({...$,local_id:L.id}))))}t.session_npcs_importantes&&t.session_npcs_importantes.length>0&&_.push(m.from("session_npcs_importantes").insert(t.session_npcs_importantes.map(x=>({...x,session_id:o})))),t.session_encontros_desafios&&t.session_encontros_desafios.length>0&&_.push(m.from("session_encontros_desafios").insert(t.session_encontros_desafios.map(x=>({...x,session_id:o})))),t.session_segredos_rumores&&t.session_segredos_rumores.length>0&&_.push(m.from("session_segredos_rumores").insert(t.session_segredos_rumores.map(x=>({...x,session_id:o})))),t.session_tesouros_recompensas&&t.session_tesouros_recompensas.length>0&&_.push(m.from("session_tesouros_recompensas").insert(t.session_tesouros_recompensas.map(x=>({...x,session_id:o})))),await Promise.all(_);const A=this.sessions.findIndex(x=>x.id===o);A!==-1&&(this.sessions[A]=j),this.activeSession&&this.activeSession.id===o&&await this.fetchLatestSessionWithDetails(k)}catch(o){this.error=o.message}finally{this.loading=!1}},async deleteSession(t,o){this.loading=!0,this.error=null;try{const{error:f}=await m.from("sessions").delete().eq("id",t);if(f)throw f;this.sessions=this.sessions.filter(q=>q.id!==t),this.activeSession&&this.activeSession.id===t&&await this.fetchLatestSessionWithDetails(o)}catch(f){this.error=f.message}finally{this.loading=!1}}}}),ie={class:"p-4 bg-white dark:bg-slate-800 rounded-lg shadow-md h-full flex flex-col"},re={class:"text-2xl font-bold text-amber-700 dark:text-amber-500 mb-4"},le={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},de={class:"mb-4 relative"},ce={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none mt-6"},ue={class:"mb-4 relative"},me={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none mt-6"},pe={class:"mb-4 relative"},_e={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none mt-6"},fe={class:"mb-4 relative"},ge={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none mt-6"},be={class:"mt-6 p-4 border rounded-lg shadow-sm bg-slate-50 dark:bg-slate-700 border-gray-300 dark:border-slate-600"},he={class:"text-lg font-bold mb-3 text-slate-800 dark:text-slate-100 flex items-center gap-x-2"},xe={class:"relative"},ve=["for"],ke={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none mt-6"},ye=["id","onUpdate:modelValue"],we={class:"md:col-span-2 relative"},$e=["for"],Se={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none mt-6"},Ce=["id","onUpdate:modelValue"],je=["onClick"],Ee={class:"mt-6 p-4 border rounded-lg shadow-sm bg-slate-50 dark:bg-slate-700 border-gray-300 dark:border-slate-600"},Ve={class:"text-lg font-bold mb-3 text-slate-800 dark:text-slate-100 flex items-center gap-x-2"},Ue={class:"relative"},Ne=["for"],qe={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none mt-6"},Te=["id","onUpdate:modelValue"],Pe={class:"md:col-span-2 relative"},Ae=["for"],Le={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none mt-6"},Re=["id","onUpdate:modelValue"],Ge=["onClick"],Me={class:"mt-6 p-4 border rounded-lg shadow-sm bg-slate-50 dark:bg-slate-700 border-gray-300 dark:border-slate-600"},Fe={class:"text-lg font-bold mb-3 text-slate-800 dark:text-slate-100 flex items-center gap-x-2"},Oe={class:"flex justify-between items-center mb-2 relative"},Be=["for"],We={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none mt-6"},Ie=["id","onUpdate:modelValue"],ze=["onClick"],He={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none mt-6"},Je=["id","onUpdate:modelValue"],Ke=["onClick"],Qe=["onClick"],Xe={class:"mt-6 p-4 border rounded-lg shadow-sm bg-slate-50 dark:bg-slate-700 border-gray-300 dark:border-slate-600"},Ye={class:"text-lg font-bold mb-3 text-slate-800 dark:text-slate-100 flex items-center gap-x-2"},Ze={class:"relative"},De=["for"],es={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none mt-6"},ss=["id","onUpdate:modelValue"],ts=["onClick"],os={class:"mt-6 p-4 border rounded-lg shadow-sm bg-slate-50 dark:bg-slate-700 border-gray-300 dark:border-slate-600"},ns={class:"text-lg font-bold mb-3 text-slate-800 dark:text-slate-100 flex items-center gap-x-2"},as={class:"relative"},is=["for"],rs={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none mt-6"},ls=["id","onUpdate:modelValue"],ds={class:"relative"},cs=["for"],us={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none mt-6"},ms=["id","onUpdate:modelValue"],ps={class:"relative"},_s=["for"],fs={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none mt-6"},gs=["id","onUpdate:modelValue"],bs=["onClick"],hs={class:"mt-6 p-4 border rounded-lg shadow-sm bg-slate-50 dark:bg-slate-700 border-gray-300 dark:border-slate-600"},xs={class:"text-lg font-bold mb-3 text-slate-800 dark:text-slate-100 flex items-center gap-x-2"},vs={class:"relative"},ks=["for"],ys={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none mt-6"},ws=["id","onUpdate:modelValue"],$s=["onClick"],Ss={class:"mt-6 p-4 border rounded-lg shadow-sm bg-slate-50 dark:bg-slate-700 border-gray-300 dark:border-slate-600"},Cs={class:"text-lg font-bold mb-3 text-slate-800 dark:text-slate-100 flex items-center gap-x-2"},js={class:"relative"},Es=["for"],Vs={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none mt-6"},Us=["id","onUpdate:modelValue"],Ns={class:"md:col-span-2"},qs=["for"],Ts={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none mt-6"},Ps=["id","onUpdate:modelValue"],As=["onClick"],Ls={class:"flex justify-end space-x-2 mt-6"},Rs={type:"submit",class:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-amber-600 hover:bg-amber-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500 flex items-center gap-x-2"},Q={__name:"SessionForm",props:{session:{type:Object,default:null},campaignId:{type:Number,required:!0}},emits:["save","close"],setup(t,{emit:o}){const f=t,q=o,r=P({title:"",description:"",comeco_forte:"",gancho_proxima_aventura:"",session_objetivos:[],session_ganchos_personagens:[],session_locais_interessantes:[],session_npcs_importantes:[],session_encontros_desafios:[],session_segredos_rumores:[],session_tesouros_recompensas:[]});I(()=>f.session,b=>{b?r.value={...b,session_objetivos:b.session_objetivos||[],session_ganchos_personagens:b.session_ganchos_personagens||[],session_locais_interessantes:b.session_locais_interessantes||[],session_npcs_importantes:b.session_npcs_importantes||[],session_encontros_desafios:b.session_encontros_desafios||[],session_segredos_rumores:b.session_segredos_rumores||[],session_tesouros_recompensas:b.session_tesouros_recompensas||[]}:r.value={title:"",description:"",comeco_forte:"",gancho_proxima_aventura:"",session_objetivos:[],session_ganchos_personagens:[],session_locais_interessantes:[],session_npcs_importantes:[],session_encontros_desafios:[],session_segredos_rumores:[],session_tesouros_recompensas:[]}},{immediate:!0});const C=()=>{r.value.session_objetivos.push({type:"",description:""})},k=b=>{r.value.session_objetivos.splice(b,1)},j=()=>{r.value.session_ganchos_personagens.push({personagem_name:"",description:""})},w=b=>{r.value.session_ganchos_personagens.splice(b,1)},y=()=>{r.value.session_locais_interessantes.push({name:"",session_locais_caracteristicas:[]})},_=b=>{r.value.session_locais_interessantes.splice(b,1)},A=b=>{r.value.session_locais_interessantes[b].session_locais_caracteristicas.push({description:""})},x=(b,s)=>{r.value.session_locais_interessantes[b].session_locais_caracteristicas.splice(s,1)},L=()=>{r.value.session_npcs_importantes.push({npc_id:null})},R=b=>{r.value.session_npcs_importantes.splice(b,1)},$=()=>{r.value.session_encontros_desafios.push({title:"",description:"",mecanica:""})},h=b=>{r.value.session_encontros_desafios.splice(b,1)},u=()=>{r.value.session_segredos_rumores.push({description:""})},S=b=>{r.value.session_segredos_rumores.splice(b,1)},g=()=>{r.value.session_tesouros_recompensas.push({name:"",description_mecanica:""})},G=b=>{r.value.session_tesouros_recompensas.splice(b,1)},W=()=>{q("save",{...r.value,campaign_id:f.campaignId})};return(b,s)=>{const d=K("font-awesome-icon");return n(),i("div",ie,[e("h2",re,v(t.session?.id?"Editar Sessão":"Nova Sessão"),1),e("form",{onSubmit:Y(W,["prevent"]),class:"flex flex-col flex-grow overflow-y-auto"},[e("div",le,[e("div",de,[s[5]||(s[5]=e("label",{for:"title",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Título",-1)),e("div",ce,[a(d,{icon:["fas","heading"],class:"text-gray-400"})]),E(e("input",{type:"text",id:"title","onUpdate:modelValue":s[0]||(s[0]=c=>r.value.title=c),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring-amber-500 dark:bg-slate-700 dark:border-slate-600 dark:text-white pl-10",required:""},null,512),[[V,r.value.title]])]),e("div",ue,[s[6]||(s[6]=e("label",{for:"description",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Descrição",-1)),e("div",me,[a(d,{icon:["fas","align-left"],class:"text-gray-400"})]),E(e("textarea",{id:"description","onUpdate:modelValue":s[1]||(s[1]=c=>r.value.description=c),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring-amber-500 dark:bg-slate-700 dark:border-slate-600 dark:text-white pl-10"},null,512),[[V,r.value.description]])]),e("div",pe,[s[7]||(s[7]=e("label",{for:"comeco_forte",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Começo Forte",-1)),e("div",_e,[a(d,{icon:["fas","bolt"],class:"text-gray-400"})]),E(e("textarea",{id:"comeco_forte","onUpdate:modelValue":s[2]||(s[2]=c=>r.value.comeco_forte=c),rows:"2",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring-amber-500 dark:bg-slate-700 dark:border-slate-600 dark:text-white pl-10"},null,512),[[V,r.value.comeco_forte]])]),e("div",fe,[s[8]||(s[8]=e("label",{for:"gancho_proxima_aventura",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Gancho Próxima Aventura",-1)),e("div",ge,[a(d,{icon:["fas","arrow-right"],class:"text-gray-400"})]),E(e("textarea",{id:"gancho_proxima_aventura","onUpdate:modelValue":s[3]||(s[3]=c=>r.value.gancho_proxima_aventura=c),rows:"2",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring-amber-500 dark:bg-slate-700 dark:border-slate-600 dark:text-white pl-10"},null,512),[[V,r.value.gancho_proxima_aventura]])])]),e("div",be,[e("h3",he,[a(d,{icon:["fas","bullseye"]}),s[9]||(s[9]=e("span",null,"Objetivos",-1))]),(n(!0),i(U,null,N(r.value.session_objetivos,(c,l)=>(n(),i("div",{key:l,class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-3 items-end p-3 border rounded-lg bg-white dark:bg-slate-800"},[e("div",xe,[e("label",{for:`objetivo-type-${l}`,class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Tipo:",8,ve),e("div",ke,[a(d,{icon:["fas","tag"],class:"text-gray-400"})]),E(e("input",{type:"text",id:`objetivo-type-${l}`,"onUpdate:modelValue":p=>c.type=p,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring-amber-500 dark:bg-slate-600 dark:border-slate-500 dark:text-white pl-10"},null,8,ye),[[V,c.type]])]),e("div",we,[e("label",{for:`objetivo-description-${l}`,class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Descrição:",8,$e),e("div",Se,[a(d,{icon:["fas","align-left"],class:"text-gray-400"})]),E(e("textarea",{id:`objetivo-description-${l}`,"onUpdate:modelValue":p=>c.description=p,rows:"1",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring-amber-500 dark:bg-slate-600 dark:border-slate-500 dark:text-white pl-10"},null,8,Ce),[[V,c.description]])]),e("button",{type:"button",onClick:p=>k(l),class:"bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline flex items-center justify-center gap-x-2"},[a(d,{icon:["fas","trash"]}),s[10]||(s[10]=e("span",null,"Remover",-1))],8,je)]))),128)),e("button",{type:"button",onClick:C,class:"mt-2 bg-amber-500 hover:bg-amber-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline flex items-center justify-center gap-x-2"},[a(d,{icon:["fas","plus"]}),s[11]||(s[11]=e("span",null,"Adicionar Objetivo",-1))])]),e("div",Ee,[e("h3",Ve,[a(d,{icon:["fas","user-tag"]}),s[12]||(s[12]=e("span",null,"Ganchos de Personagens",-1))]),(n(!0),i(U,null,N(r.value.session_ganchos_personagens,(c,l)=>(n(),i("div",{key:l,class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-3 items-end p-3 border rounded-lg bg-white dark:bg-slate-800"},[e("div",Ue,[e("label",{for:`gancho-personagem-${l}`,class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Nome do Personagem:",8,Ne),e("div",qe,[a(d,{icon:["fas","user"],class:"text-gray-400"})]),E(e("input",{type:"text",id:`gancho-personagem-${l}`,"onUpdate:modelValue":p=>c.personagem_name=p,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring-amber-500 dark:bg-slate-600 dark:border-slate-500 dark:text-white pl-10"},null,8,Te),[[V,c.personagem_name]])]),e("div",Pe,[e("label",{for:`gancho-description-${l}`,class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Descrição:",8,Ae),e("div",Le,[a(d,{icon:["fas","align-left"],class:"text-gray-400"})]),E(e("textarea",{id:`gancho-description-${l}`,"onUpdate:modelValue":p=>c.description=p,rows:"1",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring-amber-500 dark:bg-slate-600 dark:border-slate-500 dark:text-white pl-10"},null,8,Re),[[V,c.description]])]),e("button",{type:"button",onClick:p=>w(l),class:"bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline flex items-center justify-center gap-x-2"},[a(d,{icon:["fas","trash"]}),s[13]||(s[13]=e("span",null,"Remover",-1))],8,Ge)]))),128)),e("button",{type:"button",onClick:j,class:"mt-2 bg-amber-500 hover:bg-amber-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline flex items-center justify-center gap-x-2"},[a(d,{icon:["fas","plus"]}),s[14]||(s[14]=e("span",null,"Adicionar Gancho",-1))])]),e("div",Me,[e("h3",Fe,[a(d,{icon:["fas","map-marker-alt"]}),s[15]||(s[15]=e("span",null,"Locais Interessantes",-1))]),(n(!0),i(U,null,N(r.value.session_locais_interessantes,(c,l)=>(n(),i("div",{key:l,class:"mb-4 p-3 border rounded-lg bg-white dark:bg-slate-800"},[e("div",Oe,[e("label",{for:`local-name-${l}`,class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Nome do Local:",8,Be),e("div",We,[a(d,{icon:["fas","map-pin"],class:"text-gray-400"})]),E(e("input",{type:"text",id:`local-name-${l}`,"onUpdate:modelValue":p=>c.name=p,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring-amber-500 dark:bg-slate-600 dark:border-slate-500 dark:text-white pl-10"},null,8,Ie),[[V,c.name]]),e("button",{type:"button",onClick:p=>_(l),class:"bg-red-500 hover:bg-red-600 text-white font-bold py-1 px-2 rounded focus:outline-none focus:shadow-outline text-sm flex items-center justify-center gap-x-1"},[a(d,{icon:["fas","trash"]}),s[16]||(s[16]=e("span",null,"Remover Local",-1))],8,ze)]),s[19]||(s[19]=e("h4",{class:"text-md font-semibold mb-2 text-slate-700 dark:text-slate-200"},"Características:",-1)),(n(!0),i(U,null,N(c.session_locais_caracteristicas,(p,M)=>(n(),i("div",{key:M,class:"flex gap-4 mb-2 items-end relative"},[e("div",He,[a(d,{icon:["fas","info-circle"],class:"text-gray-400"})]),E(e("textarea",{id:`carac-description-${l}-${M}`,"onUpdate:modelValue":O=>p.description=O,rows:"1",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring-amber-500 dark:bg-slate-600 dark:border-slate-500 dark:text-white pl-10"},null,8,Je),[[V,p.description]]),e("button",{type:"button",onClick:O=>x(l,M),class:"bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline flex items-center justify-center gap-x-2"},[a(d,{icon:["fas","trash"]}),s[17]||(s[17]=e("span",null,"Remover",-1))],8,Ke)]))),128)),e("button",{type:"button",onClick:p=>A(l),class:"mt-2 bg-amber-500 hover:bg-amber-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline flex items-center justify-center gap-x-2"},[a(d,{icon:["fas","plus"]}),s[18]||(s[18]=e("span",null,"Adicionar Característica",-1))],8,Qe)]))),128)),e("button",{type:"button",onClick:y,class:"mt-2 bg-amber-500 hover:bg-amber-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline flex items-center justify-center gap-x-2"},[a(d,{icon:["fas","plus"]}),s[20]||(s[20]=e("span",null,"Adicionar Local",-1))])]),e("div",Xe,[e("h3",Ye,[a(d,{icon:["fas","user-friends"]}),s[21]||(s[21]=e("span",null,"NPCs Importantes",-1))]),(n(!0),i(U,null,N(r.value.session_npcs_importantes,(c,l)=>(n(),i("div",{key:l,class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3 items-end p-3 border rounded-lg bg-white dark:bg-slate-800"},[e("div",Ze,[e("label",{for:`npc-id-${l}`,class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"ID do NPC:",8,De),e("div",es,[a(d,{icon:["fas","id-badge"],class:"text-gray-400"})]),E(e("input",{type:"number",id:`npc-id-${l}`,"onUpdate:modelValue":p=>c.npc_id=p,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring-amber-500 dark:bg-slate-600 dark:border-slate-500 dark:text-white pl-10"},null,8,ss),[[V,c.npc_id]])]),e("button",{type:"button",onClick:p=>R(l),class:"bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline flex items-center justify-center gap-x-2"},[a(d,{icon:["fas","trash"]}),s[22]||(s[22]=e("span",null,"Remover",-1))],8,ts)]))),128)),e("button",{type:"button",onClick:L,class:"mt-2 bg-amber-500 hover:bg-amber-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline flex items-center justify-center gap-x-2"},[a(d,{icon:["fas","plus"]}),s[23]||(s[23]=e("span",null,"Adicionar NPC",-1))])]),e("div",os,[e("h3",ns,[a(d,{icon:["fas","dragon"]}),s[24]||(s[24]=e("span",null,"Encontros e Desafios",-1))]),(n(!0),i(U,null,N(r.value.session_encontros_desafios,(c,l)=>(n(),i("div",{key:l,class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-3 items-end p-3 border rounded-lg bg-white dark:bg-slate-800"},[e("div",as,[e("label",{for:`encontro-title-${l}`,class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Título:",8,is),e("div",rs,[a(d,{icon:["fas","heading"],class:"text-gray-400"})]),E(e("input",{type:"text",id:`encontro-title-${l}`,"onUpdate:modelValue":p=>c.title=p,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring-amber-500 dark:bg-slate-600 dark:border-slate-500 dark:text-white pl-10"},null,8,ls),[[V,c.title]])]),e("div",ds,[e("label",{for:`encontro-description-${l}`,class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Descrição:",8,cs),e("div",us,[a(d,{icon:["fas","align-left"],class:"text-gray-400"})]),E(e("textarea",{id:`encontro-description-${l}`,"onUpdate:modelValue":p=>c.description=p,rows:"1",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring-amber-500 dark:bg-slate-600 dark:border-slate-500 dark:text-white pl-10"},null,8,ms),[[V,c.description]])]),e("div",ps,[e("label",{for:`encontro-mecanica-${l}`,class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Mecânica:",8,_s),e("div",fs,[a(d,{icon:["fas","cogs"],class:"text-gray-400"})]),E(e("input",{type:"text",id:`encontro-mecanica-${l}`,"onUpdate:modelValue":p=>c.mecanica=p,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring-amber-500 dark:bg-slate-600 dark:border-slate-500 dark:text-white pl-10"},null,8,gs),[[V,c.mecanica]])]),e("button",{type:"button",onClick:p=>h(l),class:"bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline flex items-center justify-center gap-x-2"},[a(d,{icon:["fas","trash"]}),s[25]||(s[25]=e("span",null,"Remover",-1))],8,bs)]))),128)),e("button",{type:"button",onClick:$,class:"mt-2 bg-amber-500 hover:bg-amber-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline flex items-center justify-center gap-x-2"},[a(d,{icon:["fas","plus"]}),s[26]||(s[26]=e("span",null,"Adicionar Encontro",-1))])]),e("div",hs,[e("h3",xs,[a(d,{icon:["fas","mask"]}),s[27]||(s[27]=e("span",null,"Segredos e Rumores",-1))]),(n(!0),i(U,null,N(r.value.session_segredos_rumores,(c,l)=>(n(),i("div",{key:l,class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3 items-end p-3 border rounded-lg bg-white dark:bg-slate-800"},[e("div",vs,[e("label",{for:`segredo-description-${l}`,class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Descrição:",8,ks),e("div",ys,[a(d,{icon:["fas","align-left"],class:"text-gray-400"})]),E(e("textarea",{id:`segredo-description-${l}`,"onUpdate:modelValue":p=>c.description=p,rows:"1",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring-amber-500 dark:bg-slate-600 dark:border-slate-500 dark:text-white pl-10"},null,8,ws),[[V,c.description]])]),e("button",{type:"button",onClick:p=>S(l),class:"bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline flex items-center justify-center gap-x-2"},[a(d,{icon:["fas","trash"]}),s[28]||(s[28]=e("span",null,"Remover",-1))],8,$s)]))),128)),e("button",{type:"button",onClick:u,class:"mt-2 bg-amber-500 hover:bg-amber-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline flex items-center justify-center gap-x-2"},[a(d,{icon:["fas","plus"]}),s[29]||(s[29]=e("span",null,"Adicionar Segredo",-1))])]),e("div",Ss,[e("h3",Cs,[a(d,{icon:["fas","coins"]}),s[30]||(s[30]=e("span",null,"Tesouros e Recompensas",-1))]),(n(!0),i(U,null,N(r.value.session_tesouros_recompensas,(c,l)=>(n(),i("div",{key:l,class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-3 items-end p-3 border rounded-lg bg-white dark:bg-slate-800"},[e("div",js,[e("label",{for:`tesouro-name-${l}`,class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Nome:",8,Es),e("div",Vs,[a(d,{icon:["fas","gem"],class:"text-gray-400"})]),E(e("input",{type:"text",id:`tesouro-name-${l}`,"onUpdate:modelValue":p=>c.name=p,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring-amber-500 dark:bg-slate-600 dark:border-slate-500 dark:text-white pl-10"},null,8,Us),[[V,c.name]])]),e("div",Ns,[e("label",{for:`tesouro-description-${l}`,class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Descrição Mecânica:",8,qs),e("div",Ts,[a(d,{icon:["fas","scroll"],class:"text-gray-400"})]),E(e("textarea",{id:`tesouro-description-${l}`,"onUpdate:modelValue":p=>c.description_mecanica=p,rows:"1",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring-amber-500 dark:bg-slate-600 dark:border-slate-500 dark:text-white pl-10"},null,8,Ps),[[V,c.description_mecanica]])]),e("button",{type:"button",onClick:p=>G(l),class:"bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline flex items-center justify-center gap-x-2"},[a(d,{icon:["fas","trash"]}),s[31]||(s[31]=e("span",null,"Remover",-1))],8,As)]))),128)),e("button",{type:"button",onClick:g,class:"mt-2 bg-amber-500 hover:bg-amber-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline flex items-center justify-center gap-x-2"},[a(d,{icon:["fas","plus"]}),s[32]||(s[32]=e("span",null,"Adicionar Tesouro",-1))])]),e("div",Ls,[e("button",{type:"button",onClick:s[4]||(s[4]=c=>q("close")),class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500 dark:bg-slate-600 dark:border-slate-500 dark:text-white dark:hover:bg-slate-500 flex items-center gap-x-2"},[a(d,{icon:["fas","times"]}),s[33]||(s[33]=e("span",null,"Cancelar",-1))]),e("button",Rs,[a(d,{icon:["fas","save"]}),s[34]||(s[34]=e("span",null,"Salvar",-1))])])],32)])}}},Gs={class:"md:col-span-2 bg-white dark:bg-slate-800 p-6 rounded-lg shadow min-h-[400px]"},Ms={key:0,class:"text-center text-slate-500 dark:text-slate-400 flex items-center justify-center h-full"},Fs={key:1},Os={key:2,class:"h-full flex flex-col"},Bs={class:"text-2xl font-bold text-amber-700 dark:text-amber-500 mb-2"},Ws={class:"text-sm text-slate-600 dark:text-slate-400 mb-4"},Is={key:0},zs={class:"grid grid-cols-1 gap-4 flex-grow overflow-y-auto"},Hs={class:"bg-slate-50 dark:bg-slate-700 p-4 rounded-lg shadow"},Js={class:"font-bold mb-1 flex items-center gap-x-2 dark:text-slate-100"},Ks={class:"text-slate-600 dark:text-slate-400"},Qs={class:"bg-slate-50 dark:bg-slate-700 p-4 rounded-lg shadow"},Xs={class:"font-bold mb-1 flex items-center gap-x-2 dark:text-slate-100"},Ys={class:"text-slate-600 dark:text-slate-400"},Zs={class:"bg-slate-50 dark:bg-slate-700 p-4 rounded-lg shadow"},Ds={class:"font-bold mb-1 flex items-center gap-x-2 dark:text-slate-100"},et={class:"text-slate-600 dark:text-slate-400"},st={class:"grid grid-cols-1 gap-4"},tt={class:"bg-slate-50 dark:bg-slate-700 p-4 rounded-lg shadow"},ot={class:"font-bold mb-2 flex items-center gap-x-2 dark:text-slate-100"},nt={key:0},at={class:"font-semibold"},it={key:1,class:"text-slate-600 dark:text-slate-400"},rt={class:"bg-slate-50 dark:bg-slate-700 p-4 rounded-lg shadow"},lt={class:"font-bold mb-2 flex items-center gap-x-2 dark:text-slate-100"},dt={key:0},ct={class:"font-semibold"},ut={key:0,class:"ml-4 list-disc list-inside"},mt={key:1,class:"text-slate-600 dark:text-slate-400"},pt={class:"bg-slate-50 dark:bg-slate-700 p-4 rounded-lg shadow"},_t={class:"font-bold mb-2 flex items-center gap-x-2 dark:text-slate-100"},ft={key:0},gt={key:1,class:"text-slate-600 dark:text-slate-400"},bt={class:"bg-slate-50 dark:bg-slate-700 p-4 rounded-lg shadow"},ht={class:"font-bold mb-2 flex items-center gap-x-2 dark:text-slate-100"},xt={key:0},vt={class:"font-semibold"},kt={key:1,class:"text-slate-600 dark:text-slate-400"},yt={class:"bg-slate-50 dark:bg-slate-700 p-4 rounded-lg shadow"},wt={class:"font-bold mb-2 flex items-center gap-x-2 dark:text-slate-100"},$t={key:0},St={key:1,class:"text-slate-600 dark:text-slate-400"},Ct={class:"bg-slate-50 dark:bg-slate-700 p-4 rounded-lg shadow"},jt={class:"font-bold mb-2 flex items-center gap-x-2 dark:text-slate-100"},Et={key:0},Vt={class:"font-semibold"},Ut={key:1,class:"text-slate-600 dark:text-slate-400"},Nt={class:"bg-slate-50 dark:bg-slate-700 p-4 rounded-lg shadow"},qt={class:"font-bold mb-2 flex items-center gap-x-2 dark:text-slate-100"},Tt={key:0},Pt={class:"font-semibold"},At={key:1,class:"text-slate-600 dark:text-slate-400"},Lt={class:"bg-slate-50 dark:bg-slate-700 p-4 rounded-lg shadow"},Rt={class:"font-bold mb-2 flex items-center gap-x-2 dark:text-slate-100"},Gt={class:"text-slate-600 dark:text-slate-400"},Mt={__name:"SessionDetailsView",props:{selectedSession:{type:Object,default:null},selectedCampaignName:{type:String,default:""},isEditMode:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["sessionUpdated","creationCancelled","startEditing"],setup(t,{emit:o}){const f=t,q=o,r=P([]),C=P([]),k=P([]),j=P([]),w=P([]),y=P([]),_=P([]),A=async h=>{if(!h){x();return}try{const{data:u,error:S}=await m.from("session_ganchos_personagens").select("*").eq("session_id",h);if(S)throw S;r.value=u;const{data:g,error:G}=await m.from("session_locais_interessantes").select(`
        *,
        caracteristicas:session_locais_caracteristicas(*)
      `).eq("session_id",h);if(G)throw G;C.value=g;const{data:W,error:b}=await m.from("session_npcs_importantes").select(`
        *,
        npcs(name)
      `).eq("session_id",h);if(b)throw b;k.value=W.map(H=>({...H,name:H.npcs.name}));const{data:s,error:d}=await m.from("session_objetivos").select("*").eq("session_id",h);if(d)throw d;j.value=s;const{data:c,error:l}=await m.from("session_segredos_rumores").select("*").eq("session_id",h);if(l)throw l;w.value=c;const{data:p,error:M}=await m.from("session_tesouros_recompensas").select("*").eq("session_id",h);if(M)throw M;y.value=p;const{data:O,error:z}=await m.from("session_encontros_desafios").select("*").eq("session_id",h);if(z)throw z;_.value=O}catch(u){console.error("Erro ao buscar detalhes da sessão:",u.message),x()}},x=()=>{r.value=[],C.value=[],k.value=[],j.value=[],w.value=[],y.value=[],_.value=[]};I(()=>f.selectedSession,h=>{h&&!f.isEditMode?A(h.id):h||x()},{immediate:!0});const L=async h=>{try{h.id?await m.from("sessions").update(h).eq("id",h.id):await m.from("sessions").insert(h),q("sessionUpdated")}catch(u){console.error("Erro ao salvar sessão:",u.message)}},R=()=>{q("creationCancelled")},$=h=>{if(!h)return"";const u={year:"numeric",month:"long",day:"numeric"};return new Date(h).toLocaleDateString("pt-BR",u)};return(h,u)=>{const S=K("font-awesome-icon");return n(),i("div",Gs,[t.loading?(n(),i("div",Ms,u[0]||(u[0]=[e("p",{class:"text-lg"},"Carregando Sessões...",-1)]))):t.isEditMode?(n(),i("div",Fs,[a(Q,{session:t.selectedSession,onSave:L,onClose:R},null,8,["session"])])):t.selectedSession?(n(),i("div",Os,[e("h3",Bs,v(t.selectedSession.title),1),e("p",Ws,[t.selectedSession.campaign_id?(n(),i("span",Is,"Campanha: "+v(t.selectedCampaignName)+" • ",1)):B("",!0),F(" Criada em: "+v($(t.selectedSession.created_at)),1)]),e("div",zs,[e("div",Hs,[e("h4",Js,[a(S,{icon:["fas","book-open"],class:"text-slate-500"}),u[1]||(u[1]=e("span",null,"Descrição",-1))]),e("p",Ks,v(t.selectedSession.description||"Nenhuma descrição."),1)]),e("div",Qs,[e("h4",Xs,[a(S,{icon:["fas","bolt"],class:"text-slate-500"}),u[2]||(u[2]=e("span",null,"Começo Forte",-1))]),e("p",Ys,v(t.selectedSession.comeco_forte||"Nenhum começo forte definido"),1)]),e("div",Zs,[e("h4",Ds,[a(S,{icon:["fas","arrow-right"],class:"text-slate-500"}),u[3]||(u[3]=e("span",null,"Gancho Próxima Aventura",-1))]),e("p",et,v(t.selectedSession.gancho_proxima_aventura||"Nenhum gancho definido."),1)]),e("div",st,[u[12]||(u[12]=e("h3",{class:"text-xl font-bold text-amber-700 dark:text-amber-500 mb-3"},"Detalhes da Sessão",-1)),e("div",tt,[e("h4",ot,[a(S,{icon:["fas","user-tag"],class:"text-slate-500"}),u[4]||(u[4]=e("span",null,"Ganchos de Personagens",-1))]),r.value.length?(n(),i("ul",nt,[(n(!0),i(U,null,N(r.value,g=>(n(),i("li",{key:g.id,class:"text-slate-600 dark:text-slate-400 mb-1"},[e("span",at,v(g.personagem_name||"Geral")+":",1),F(" "+v(g.description),1)]))),128))])):(n(),i("p",it,"Nenhum gancho de personagem."))]),e("div",rt,[e("h4",lt,[a(S,{icon:["fas","map-marker-alt"],class:"text-slate-500"}),u[5]||(u[5]=e("span",null,"Locais Interessantes",-1))]),C.value.length?(n(),i("ul",dt,[(n(!0),i(U,null,N(C.value,g=>(n(),i("li",{key:g.id,class:"text-slate-600 dark:text-slate-400 mb-1"},[e("span",ct,v(g.name),1),g.caracteristicas&&g.caracteristicas.length?(n(),i("ul",ut,[(n(!0),i(U,null,N(g.caracteristicas,G=>(n(),i("li",{key:G.id},v(G.description),1))),128))])):B("",!0)]))),128))])):(n(),i("p",mt,"Nenhum local interessante."))]),e("div",pt,[e("h4",_t,[a(S,{icon:["fas","user-friends"],class:"text-slate-500"}),u[6]||(u[6]=e("span",null,"NPCs Importantes",-1))]),k.value.length?(n(),i("ul",ft,[(n(!0),i(U,null,N(k.value,g=>(n(),i("li",{key:g.id,class:"text-slate-600 dark:text-slate-400"},v(g.name),1))),128))])):(n(),i("p",gt,"Nenhum NPC importante."))]),e("div",bt,[e("h4",ht,[a(S,{icon:["fas","bullseye"],class:"text-slate-500"}),u[7]||(u[7]=e("span",null,"Objetivos",-1))]),j.value.length?(n(),i("ul",xt,[(n(!0),i(U,null,N(j.value,g=>(n(),i("li",{key:g.id,class:"text-slate-600 dark:text-slate-400"},[e("span",vt,v(g.type)+":",1),F(" "+v(g.description),1)]))),128))])):(n(),i("p",kt,"Nenhum objetivo."))]),e("div",yt,[e("h4",wt,[a(S,{icon:["fas","mask"],class:"text-slate-500"}),u[8]||(u[8]=e("span",null,"Segredos e Rumores",-1))]),w.value.length?(n(),i("ul",$t,[(n(!0),i(U,null,N(w.value,g=>(n(),i("li",{key:g.id,class:"text-slate-600 dark:text-slate-400"},v(g.description),1))),128))])):(n(),i("p",St,"Nenhum segredo ou rumor."))]),e("div",Ct,[e("h4",jt,[a(S,{icon:["fas","coins"],class:"text-slate-500"}),u[9]||(u[9]=e("span",null,"Tesouros e Recompensas",-1))]),y.value.length?(n(),i("ul",Et,[(n(!0),i(U,null,N(y.value,g=>(n(),i("li",{key:g.id,class:"text-slate-600 dark:text-slate-400"},[e("span",Vt,v(g.name)+":",1),F(" "+v(g.description_mecanica||"Sem descrição mecânica."),1)]))),128))])):(n(),i("p",Ut,"Nenhum tesouro ou recompensa."))]),e("div",Nt,[e("h4",qt,[a(S,{icon:["fas","dragon"],class:"text-slate-500"}),u[10]||(u[10]=e("span",null,"Encontros e Desafios",-1))]),_.value.length?(n(),i("ul",Tt,[(n(!0),i(U,null,N(_.value,g=>(n(),i("li",{key:g.id,class:"text-slate-600 dark:text-slate-400"},[e("span",Pt,v(g.title)+":",1),F(" "+v(g.description||"Sem descrição.")+" (Mecânica: "+v(g.mecanica||"N/A")+") ",1)]))),128))])):(n(),i("p",At,"Nenhum encontro ou desafio."))]),e("div",Lt,[e("h4",Rt,[a(S,{icon:["fas","arrow-right"],class:"text-slate-500"}),u[11]||(u[11]=e("span",null,"Gancho para Próxima Aventura",-1))]),e("p",Gt,v(t.selectedSession.gancho_proxima_aventura||"Nenhum gancho definido."),1)])])])])):B("",!0)])}}},Ft={id:"sessoes",class:"h-full"},Ot={class:"grid grid-cols-1 md:grid-cols-3 gap-6 h-full"},Bt={class:"md:col-span-2 h-full"},Wt={__name:"SessaoAtualView",setup(t){const o=ae(),f=D(),{activeCampaign:q}=ee(f),r=P(!1),C=P(null),k=P(""),j=P(""),w=$=>{o.activeSession=$,r.value=!1},y=()=>{C.value={},r.value=!0},_=$=>{C.value={...$},r.value=!0},A=async $=>{try{await o.deleteSession($,f.activeCampaign.id),k.value="Sessão excluída com sucesso!",j.value="success",setTimeout(()=>{k.value=""},3e3)}catch(h){k.value=`Erro ao excluir sessão: ${h.message}`,j.value="error",setTimeout(()=>{k.value=""},5e3)}},x=async()=>{r.value=!1,C.value=null,k.value="Sessão salva com sucesso!",j.value="success",setTimeout(()=>{k.value=""},3e3)},L=()=>{r.value=!1,C.value=null,!o.activeSession&&o.sessions.length>0&&(o.activeSession=o.sessions[0])},R=async $=>{if(!$){o.sessions=[],o.activeSession=null;return}await o.fetchSessions($.id),await o.fetchLatestSessionWithDetails($.id),!o.activeSession&&o.sessions.length>0&&(o.activeSession=o.sessions[0]),o.sessions.length===0&&(await ne(),y())};return I(q,$=>{R($)},{immediate:!0}),se(()=>{!f.activeCampaign&&f.campaigns.length>0&&f.setActiveCampaign(f.campaigns[0]),R(f.activeCampaign)}),($,h)=>(n(),i(U,null,[e("section",Ft,[e("div",Ot,[a(te,{entities:T(o).sessions,selectedEntity:T(o).activeSession,loading:T(o).loading,error:T(o).error,entityTitle:"Sessões",entityIcon:["fas","scroll"],showCampaignFilter:!0,campaigns:T(f).campaigns,selectedCampaignId:T(f).activeCampaign?.id,"onUpdate:selectedCampaignId":h[0]||(h[0]=u=>T(f).setActiveCampaign(T(f).campaigns.find(S=>S.id===u))),onSelectEntity:w,onAddEntity:y,onDeleteEntity:A,onEditEntity:_,class:"h-full overflow-y-auto"},null,8,["entities","selectedEntity","loading","error","campaigns","selectedCampaignId"]),e("div",Bt,[r.value?(n(),J(Q,{key:1,session:C.value,campaignId:T(f).activeCampaign?.id,onSessionUpdated:x,onCreationCancelled:L,class:"h-full"},null,8,["session","campaignId"])):(n(),J(Mt,{key:0,selectedSession:T(o).activeSession,loading:T(o).loading,onStartEditing:h[1]||(h[1]=u=>_(T(o).activeSession)),class:"h-full"},null,8,["selectedSession","loading"]))])])]),k.value?(n(),i("div",{key:0,class:oe([{"bg-green-500":j.value==="success","bg-red-500":j.value==="error"},"text-white p-3 rounded-lg mt-4 text-center"])},v(k.value),3)):B("",!0)],64))}},zt=Z(Wt,[["__scopeId","data-v-a32daf76"]]);export{zt as default};
